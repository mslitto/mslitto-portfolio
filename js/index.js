var D = document,
    M = Math,
    W = window,
    $ = function (a, b) {
  return b = b || D, a.startsWith('.') ? b.getElementsByClassName(a.substr(1, a.length)) : a.startsWith('#') ? b.getElementById(a.substr(1, a.length)) : b.getElementsByTagName(a);
},
    draggableContainer = $('#draggables'),
    drag = $('.drag', draggableContainer),
    maxZIndex = 5 * drag.length,
    dragged = !1,
    startPos = !1,
    currentZIndex = 1,
    forEach = function (a, b) {
  for (var c = 0; c < a.length; c++) a.hasOwnProperty(c) && b(a[c]);
},
    cl = {
  has: function has(a, b) {
    return a.className && -1 < a.className.indexOf(b);
  },
  add: function add(a, b) {
    cl.has(a, b) || (a.className && (b = a.className + ' ' + b), a.className = b);
  },
  rm: function rm(a, b) {
    cl.has(a, b) && (a.className = a.className.replace(b, '').trim());
  },
  toggle: function toggle(a, b) {
    cl.has(a, b) ? cl.rm(a, b) : cl.add(a, b);
  }
},
    on = function (a, b, c) {
  a && a.addEventListener(b, c);
},
    getPos = function (a) {
  return parseInt(a.replace('%', ''));
},
    percentFromPixels = function (a, b) {
  return 100 * (b / W["inner".concat(a)]);
},
    pixelsFromPercent = function (a, b) {
  return b * W["inner".concat(a)] / 100;
},
    onLoad = function (a, b) {
  if (cl.has(b, 'bg')) {
    var c = b.getBoundingClientRect().width,
        d = b.getBoundingClientRect().height,
        e = 0,
        f = 0,
        g = .7 * W.innerWidth;

    if (c > g) {
      var j = c / g + .1;
      c /= j, d /= j;
    } // resize if too high


    var k = .7 * W.innerHeight;

    if (d > k) {
      var l = d / k + .1;
      d /= l, c /= l;
    }

    var h = W.innerWidth - c,
        i = W.innerHeight - d;
    e = M.random() * h, f = M.random() * i, e = "".concat(M.floor(percentFromPixels('Width', e)), "%"), f = "".concat(M.floor(percentFromPixels('Height', f)), "%"), a.style.left = e, a.style.top = f;
  }
};

forEach(drag, function (a) {
  var b = M.random(),
      c = {
    left: '100%',
    top: '100%'
  };
  .7 < b ? c.left = "-".concat(c.left) : .3 > b && (c.top = "-".concat(c.top)), a.style.left = c.left, a.style.top = c.top;
  var d = $('.bg', a)[0],
      e = $('img', d)[0];
  e.complete ? onLoad(a, e.parentNode) : on(e, 'load', function () {
    onLoad(a, e.parentNode);
  });
});

var touchHandler = function (a) {
  var b = a.changedTouches[0],
      c = D.createEvent("MouseEvent"),
      d = {
    touchstart: "mousedown",
    touchmove: "mousemove",
    touchend: "mouseup"
  }[a.type];
  return c.initMouseEvent(d, !0, !0, W, 1, b.screenX, b.screenY, b.clientX, b.clientY, !1, !1, !1, !1, 0, null), b.target.dispatchEvent(c), a.preventDefault(), a.stopPropagation(), !1;
},
    doNothing = function (a) {
  return a.preventDefault(), !1;
},
    isOutOfBounds = function (a) {
  return a.clientX >= W.innerWidth || 0 >= a.clientX || a.clientY >= W.innerHeight || 0 >= a.clientY;
},
    onDrag = function (a) {
  dragged = a.currentTarget.parentNode, cl.add(dragged, 'dragged'), startPos = {
    left: pixelsFromPercent('Width', getPos(dragged.style.left)),
    top: pixelsFromPercent('Height', getPos(dragged.style.top))
  }, currentZIndex += 1, dragged.style.zIndex = currentZIndex, dragged.offset = {
    left: a.clientX - pixelsFromPercent('Width', getPos(dragged.style.left)),
    top: a.clientY - pixelsFromPercent('Height', getPos(dragged.style.top))
  }, dragged.style.opacity = .8, on(D, 'mousemove', onMousemove), on(D, 'mouseup', onDrop), on(D, 'mouseout', onDropIfOutOfBounds);
},
    onDrop = function () {
  dragged && (forEach(drag, function (a) {
    cl.rm(a, 'dragged'), a === dragged ? cl.add(dragged, 'dropped') : cl.rm(a, 'dropped');
  }), dragged.style.opacity = 1, dragged = !1, startPos = !1);
},
    onDropIfOutOfBounds = function (a) {
  isOutOfBounds(a) && onDrop(a);
},
    onMousemove = function (a) {
  if (dragged) {
    var b = {
      left: W.innerWidth - dragged.clientWidth,
      top: W.innerHeight - dragged.clientHeight
    },
        c = a.clientX - dragged.offset.left;
    0 > c ? c = 0 : c > b.left && (c = b.left), dragged.style.left = "".concat(percentFromPixels('Width', c), "%");
    var d = a.clientY - dragged.offset.top;
    0 > d ? d = 0 : d > b.top && (d = b.top), dragged.style.top = "".concat(percentFromPixels('Height', d), "%");
  }
};

W.onload = function () {
  forEach(drag, function (b) {
    var c = $('.bg', b)[0];

    if (c) {
      on(c, 'dragstart', doNothing), on(c, 'mousedown', onDrag), on(c, "touchstart", touchHandler, !0), on(c, "touchmove", touchHandler, !0), on(c, "touchend", touchHandler, !0), on(c, "touchcancel", touchHandler, !0);
      var a = c.parentNode.style;
      (a && '100%' === a.left || '-100%' === a.left) && c.dispatchEvent(new Event('load'));
    }

    var d = $('a', b)[0];
    d && on(d, 'touchend', function (a) {
      return a.stopPropagation(), !1;
    });
  });
};

// Menu
var menuContainer = $('.nav')[0];

if (menuContainer) {
  var active = $('.active', menuContainer)[0],
      toggleMenu = function (a) {
    return a.preventDefault(), cl.toggle(menuContainer, 'show'), !1;
  };

  active && on(active, 'click', toggleMenu);
} // About page


var trigger = $('.about-page-trigger')[0];
trigger && on(trigger, "click", function (a) {
  return a.preventDefault(), cl.toggle(D.body, "about-visible"), !1;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkQiLCJkb2N1bWVudCIsIk0iLCJNYXRoIiwiVyIsIndpbmRvdyIsIiQiLCJzdHIiLCJwYXIiLCJzdGFydHNXaXRoIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInN1YnN0ciIsImxlbmd0aCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJkcmFnZ2FibGVDb250YWluZXIiLCJkcmFnIiwibWF4WkluZGV4IiwiZHJhZ2dlZCIsInN0YXJ0UG9zIiwiY3VycmVudFpJbmRleCIsImZvckVhY2giLCJpdGVtcyIsImZuIiwiaSIsImhhc093blByb3BlcnR5IiwiY2wiLCJoYXMiLCJlIiwiYyIsImNsYXNzTmFtZSIsImluZGV4T2YiLCJhZGQiLCJybSIsInJlcGxhY2UiLCJ0cmltIiwidG9nZ2xlIiwib24iLCJlbGUiLCJsaXN0ZW5lciIsImNiIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldFBvcyIsInBhcnNlSW50IiwicGVyY2VudEZyb21QaXhlbHMiLCJkaXIiLCJweCIsInBpeGVsc0Zyb21QZXJjZW50IiwicGMiLCJvbkxvYWQiLCJ0YXIiLCJ3aWR0aCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImhlaWdodCIsImxlZnQiLCJ0b3AiLCJtYXhXaWR0aCIsImlubmVyV2lkdGgiLCJ3aWR0aFBlcmNlbnQiLCJtYXhIZWlnaHQiLCJpbm5lckhlaWdodCIsImhlaWdodFBlcmNlbnQiLCJtYXhMZWZ0IiwibWF4VG9wIiwicmFuZG9tIiwiZmxvb3IiLCJzdHlsZSIsImRyYWdnYWJsZSIsInJhbiIsInBvcyIsImltZyIsImltZ1NyYyIsImNvbXBsZXRlIiwicGFyZW50Tm9kZSIsInRvdWNoSGFuZGxlciIsImV2ZW50IiwidG91Y2giLCJjaGFuZ2VkVG91Y2hlcyIsInNpbXVsYXRlZEV2ZW50IiwiY3JlYXRlRXZlbnQiLCJldnQiLCJ0b3VjaHN0YXJ0IiwidG91Y2htb3ZlIiwidG91Y2hlbmQiLCJ0eXBlIiwiaW5pdE1vdXNlRXZlbnQiLCJzY3JlZW5YIiwic2NyZWVuWSIsImNsaWVudFgiLCJjbGllbnRZIiwidGFyZ2V0IiwiZGlzcGF0Y2hFdmVudCIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiZG9Ob3RoaW5nIiwiaXNPdXRPZkJvdW5kcyIsIm9uRHJhZyIsImN1cnJlbnRUYXJnZXQiLCJ6SW5kZXgiLCJvZmZzZXQiLCJvcGFjaXR5Iiwib25Nb3VzZW1vdmUiLCJvbkRyb3AiLCJvbkRyb3BJZk91dE9mQm91bmRzIiwibWF4IiwiY2xpZW50V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJuZXdMZWZ0IiwibmV3VG9wIiwib25sb2FkIiwicGFyZW50U3R5bGUiLCJFdmVudCIsImEiLCJtZW51Q29udGFpbmVyIiwiYWN0aXZlIiwidG9nZ2xlTWVudSIsInRyaWdnZXIiLCJib2R5Il0sIm1hcHBpbmdzIjoiSUFBTUEsQ0FBQyxHQUFHQyxRO0lBQ0pDLENBQUMsR0FBR0MsSTtJQUNKQyxDQUFDLEdBQUdDLE07SUFFSkMsQ0FBQyxHQUFHLFVBQUNDLENBQUQsRUFBTUMsQ0FBTixFQUFjO0FBQUEsU0FDdEJBLENBQUcsR0FBR0EsQ0FBRyxJQUFJUixDQURTLEVBR2xCTyxDQUFHLENBQUNFLFVBQUosQ0FBZSxHQUFmLENBSGtCLEdBSWJELENBQUcsQ0FBQ0Usc0JBQUosQ0FBMkJILENBQUcsQ0FBQ0ksTUFBSixDQUFXLENBQVgsRUFBY0osQ0FBRyxDQUFDSyxNQUFsQixDQUEzQixDQUphLEdBS1hMLENBQUcsQ0FBQ0UsVUFBSixDQUFlLEdBQWYsQ0FMVyxHQU1iRCxDQUFHLENBQUNLLGNBQUosQ0FBbUJOLENBQUcsQ0FBQ0ksTUFBSixDQUFXLENBQVgsRUFBY0osQ0FBRyxDQUFDSyxNQUFsQixDQUFuQixDQU5hLEdBUWJKLENBQUcsQ0FBQ00sb0JBQUosQ0FBeUJQLENBQXpCLENBUmE7QUFVdkIsQztJQUdLUSxrQkFBa0IsR0FBR1QsQ0FBQyxDQUFDLGFBQUQsQztJQUN0QlUsSUFBSSxHQUFHVixD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LEVBQVUsT0FBVixFQUFtQixVQUFBeEYsQ0FBQyxFQUFJO0FBS3hCLFNBSkFBLENBQUMsQ0FBQ2dFLGNBQUYsRUFJQSxFQUZBbEUsRUFBRSxDQUFDVSxNQUFILENBQVVwQyxDQUFDLENBQUNxSCxJQUFaLEVBQWtCLGVBQWxCLENBRUE7QUFDRCxDQU5DLEMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBEID0gZG9jdW1lbnRcbmNvbnN0IE0gPSBNYXRoXG5jb25zdCBXID0gd2luZG93XG5cbmNvbnN0ICQgPSAoc3RyLCBwYXIpID0+IHtcbiAgcGFyID0gcGFyIHx8IERcblxuICBpZiAoc3RyLnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgIHJldHVybiBwYXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShzdHIuc3Vic3RyKDEsIHN0ci5sZW5ndGgpKVxuICB9IGVsc2UgaWYgKHN0ci5zdGFydHNXaXRoKCcjJykpIHtcbiAgICByZXR1cm4gcGFyLmdldEVsZW1lbnRCeUlkKHN0ci5zdWJzdHIoMSwgc3RyLmxlbmd0aCkpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHBhci5nZXRFbGVtZW50c0J5VGFnTmFtZShzdHIpXG4gIH1cbn1cblxuLy8gZ2xvYmFsIGRvbSBlbGVtZW50c1xuY29uc3QgZHJhZ2dhYmxlQ29udGFpbmVyID0gJCgnI2RyYWdnYWJsZXMnKVxuY29uc3QgZHJhZyA9ICQoJy5kcmFnJywgZHJhZ2dhYmxlQ29udGFpbmVyKVxuY29uc3QgbWF4WkluZGV4ID0gZHJhZy5sZW5ndGggKiA1XG5cbi8vIGdsb2JhbCBhcHAgc3RhdGVcbmxldCBkcmFnZ2VkID0gZmFsc2VcbmxldCBzdGFydFBvcyA9IGZhbHNlXG5sZXQgY3VycmVudFpJbmRleCA9IDFcblxuLy8gbG9vcCBvdmVyIGVhY2ggaXRlbSBhbmQgY2FsbCBmbihpdGVtKVxuY29uc3QgZm9yRWFjaCA9IChpdGVtcywgZm4pID0+IHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChpdGVtcy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgZm4oaXRlbXNbaV0pXG4gICAgfVxuICB9XG59XG5cbmNvbnN0IGNsID0ge1xuICBoYXMoZSwgYykge1xuICAgIHJldHVybiBlLmNsYXNzTmFtZSAmJiBlLmNsYXNzTmFtZS5pbmRleE9mKGMpID4gLTFcbiAgfSxcbiAgYWRkKGUsIGMpIHtcbiAgICBpZiAoIWNsLmhhcyhlLCBjKSkge1xuICAgICAgaWYgKGUuY2xhc3NOYW1lKSB7XG4gICAgICAgIGMgPSBlLmNsYXNzTmFtZSArICcgJyArIGNcbiAgICAgIH1cbiAgICAgIGUuY2xhc3NOYW1lID0gY1xuICAgIH1cbiAgfSxcbiAgcm0oZSwgYykge1xuICAgIGlmIChjbC5oYXMoZSwgYykpIHtcbiAgICAgIGUuY2xhc3NOYW1lID0gZS5jbGFzc05hbWUucmVwbGFjZShjLCAnJykudHJpbSgpXG4gICAgfVxuICB9LFxuICB0b2dnbGUoZSwgYykge1xuICAgIGlmIChjbC5oYXMoZSwgYykpIHtcbiAgICAgIGNsLnJtKGUsIGMpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNsLmFkZChlLCBjKVxuICAgIH1cbiAgfSxcbn1cblxuY29uc3Qgb24gPSAoZWxlLCBsaXN0ZW5lciwgY2IpID0+IHtcbiAgaWYgKGVsZSkge1xuICAgIGVsZS5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyLCBjYilcbiAgfVxufVxuXG5jb25zdCBnZXRQb3MgPSBlID0+IHBhcnNlSW50KGUucmVwbGFjZSgnJScsICcnKSlcblxuY29uc3QgcGVyY2VudEZyb21QaXhlbHMgPSAoZGlyLCBweCkgPT4gKHB4IC8gV1tgaW5uZXIke2Rpcn1gXSkgKiAxMDBcbmNvbnN0IHBpeGVsc0Zyb21QZXJjZW50ID0gKGRpciwgcGMpID0+IChwYyAqIFdbYGlubmVyJHtkaXJ9YF0pIC8gMTAwXG5cbi8vIHJlc2l6ZSBhbmQgcmVwb3NpdGlvbiBhZnRlciBsb2FkIG9mIGltYWdlc1xuY29uc3Qgb25Mb2FkID0gKHBhciwgdGFyKSA9PiB7XG4gIGlmIChjbC5oYXModGFyLCAnYmcnKSkge1xuICAgIGxldCB3aWR0aCA9IHRhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aFxuICAgIGxldCBoZWlnaHQgPSB0YXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0XG4gICAgbGV0IGxlZnQgPSAwXG4gICAgbGV0IHRvcCA9IDBcblxuICAgIC8vIHJlc2l6ZSBpZiB0b28gd2lkZVxuICAgIGNvbnN0IG1heFdpZHRoID0gVy5pbm5lcldpZHRoICogLjdcbiAgICBpZiAod2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgY29uc3Qgd2lkdGhQZXJjZW50ID0gKHdpZHRoIC8gbWF4V2lkdGgpICsgLjFcbiAgICAgIHdpZHRoIC89IHdpZHRoUGVyY2VudFxuICAgICAgaGVpZ2h0IC89IHdpZHRoUGVyY2VudFxuICAgIH1cblxuICAgIC8vIHJlc2l6ZSBpZiB0b28gaGlnaFxuICAgIGNvbnN0IG1heEhlaWdodCA9IFcuaW5uZXJIZWlnaHQgKiAuN1xuICAgIGlmIChoZWlnaHQgPiBtYXhIZWlnaHQpIHtcbiAgICAgIGNvbnN0IGhlaWdodFBlcmNlbnQgPSAoaGVpZ2h0IC8gbWF4SGVpZ2h0KSArIC4xXG4gICAgICBoZWlnaHQgLz0gaGVpZ2h0UGVyY2VudFxuICAgICAgd2lkdGggLz0gaGVpZ2h0UGVyY2VudFxuICAgIH1cblxuICAgIGNvbnN0IG1heExlZnQgPSBXLmlubmVyV2lkdGggLSB3aWR0aFxuICAgIGNvbnN0IG1heFRvcCA9IFcuaW5uZXJIZWlnaHQgLSBoZWlnaHRcbiAgICBsZWZ0ID0gTS5yYW5kb20oKSAqIG1heExlZnRcbiAgICB0b3AgPSBNLnJhbmRvbSgpICogbWF4VG9wXG4gICAgbGVmdCA9IGAke00uZmxvb3IocGVyY2VudEZyb21QaXhlbHMoJ1dpZHRoJywgbGVmdCkpfSVgXG4gICAgdG9wID0gYCR7TS5mbG9vcihwZXJjZW50RnJvbVBpeGVscygnSGVpZ2h0JywgdG9wKSl9JWBcblxuICAgIHBhci5zdHlsZS5sZWZ0ID0gbGVmdFxuICAgIHBhci5zdHlsZS50b3AgPSB0b3BcbiAgfVxufVxuXG5mb3JFYWNoKGRyYWcsIGRyYWdnYWJsZSA9PiB7XG4gIGNvbnN0IHJhbiA9IE0ucmFuZG9tKClcbiAgY29uc3QgcG9zID0ge1xuICAgIGxlZnQ6ICcxMDAlJyxcbiAgICB0b3A6ICcxMDAlJyxcbiAgfVxuXG4gIGlmIChyYW4gPiAwLjcpIHtcbiAgICBwb3MubGVmdCA9IGAtJHtwb3MubGVmdH1gXG4gIH0gZWxzZSBpZiAocmFuIDwgMC4zKSB7XG4gICAgcG9zLnRvcCA9IGAtJHtwb3MudG9wfWBcbiAgfVxuXG4gIGRyYWdnYWJsZS5zdHlsZS5sZWZ0ID0gcG9zLmxlZnRcbiAgZHJhZ2dhYmxlLnN0eWxlLnRvcCA9IHBvcy50b3BcblxuICBjb25zdCBpbWcgPSAkKCcuYmcnLCBkcmFnZ2FibGUpWzBdXG4gIGNvbnN0IGltZ1NyYyA9ICQoJ2ltZycsIGltZylbMF1cblxuICBpZiAoIWltZ1NyYy5jb21wbGV0ZSkge1xuICAgIG9uKGltZ1NyYywgJ2xvYWQnLCAoKSA9PiB7XG4gICAgICBvbkxvYWQoZHJhZ2dhYmxlLCBpbWdTcmMucGFyZW50Tm9kZSlcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIG9uTG9hZChkcmFnZ2FibGUsIGltZ1NyYy5wYXJlbnROb2RlKVxuICB9XG59KVxuXG5jb25zdCB0b3VjaEhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgY29uc3QgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXVxuICBjb25zdCBzaW11bGF0ZWRFdmVudCA9IEQuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50XCIpXG5cbiAgY29uc3QgZXZlbnROYW1lcyA9IHtcbiAgICB0b3VjaHN0YXJ0OiBcIm1vdXNlZG93blwiLFxuICAgIHRvdWNobW92ZTogXCJtb3VzZW1vdmVcIixcbiAgICB0b3VjaGVuZDogXCJtb3VzZXVwXCIsXG4gIH1cblxuICBjb25zdCBldnQgPSBldmVudE5hbWVzW2V2ZW50LnR5cGVdXG5cbiAgc2ltdWxhdGVkRXZlbnQuaW5pdE1vdXNlRXZlbnQoXG4gICAgZXZ0LCB0cnVlLCB0cnVlLCBXLCAxLFxuICAgIHRvdWNoLnNjcmVlblgsIHRvdWNoLnNjcmVlblksXG4gICAgdG91Y2guY2xpZW50WCwgdG91Y2guY2xpZW50WSxcbiAgICBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbFxuICApXG5cbiAgdG91Y2gudGFyZ2V0LmRpc3BhdGNoRXZlbnQoc2ltdWxhdGVkRXZlbnQpXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmNvbnN0IGRvTm90aGluZyA9IChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKVxuICByZXR1cm4gZmFsc2Vcbn1cblxuY29uc3QgaXNPdXRPZkJvdW5kcyA9IGUgPT4gKFxuICBlLmNsaWVudFggPj0gVy5pbm5lcldpZHRoIHx8XG4gIGUuY2xpZW50WCA8PSAwIHx8XG4gIGUuY2xpZW50WSA+PSBXLmlubmVySGVpZ2h0IHx8XG4gIGUuY2xpZW50WSA8PSAwXG4pXG5cbmNvbnN0IG9uRHJhZyA9IGV2dCA9PiB7XG4gIGRyYWdnZWQgPSBldnQuY3VycmVudFRhcmdldC5wYXJlbnROb2RlXG5cbiAgY2wuYWRkKGRyYWdnZWQsICdkcmFnZ2VkJylcblxuICBzdGFydFBvcyA9IHtcbiAgICBsZWZ0OiBwaXhlbHNGcm9tUGVyY2VudCgnV2lkdGgnLCBnZXRQb3MoZHJhZ2dlZC5zdHlsZS5sZWZ0KSksXG4gICAgdG9wOiBwaXhlbHNGcm9tUGVyY2VudCgnSGVpZ2h0JywgZ2V0UG9zKGRyYWdnZWQuc3R5bGUudG9wKSksXG4gIH1cblxuICBjdXJyZW50WkluZGV4ICs9IDFcbiAgZHJhZ2dlZC5zdHlsZS56SW5kZXggPSBjdXJyZW50WkluZGV4XG4gIGRyYWdnZWQub2Zmc2V0ID0ge1xuICAgIGxlZnQ6IGV2dC5jbGllbnRYIC0gcGl4ZWxzRnJvbVBlcmNlbnQoJ1dpZHRoJywgZ2V0UG9zKGRyYWdnZWQuc3R5bGUubGVmdCkpLFxuICAgIHRvcDogZXZ0LmNsaWVudFkgLSBwaXhlbHNGcm9tUGVyY2VudCgnSGVpZ2h0JywgZ2V0UG9zKGRyYWdnZWQuc3R5bGUudG9wKSksXG4gIH1cbiAgZHJhZ2dlZC5zdHlsZS5vcGFjaXR5ID0gMC44XG5cbiAgb24oRCwgJ21vdXNlbW92ZScsIG9uTW91c2Vtb3ZlKVxuICBvbihELCAnbW91c2V1cCcsIG9uRHJvcClcbiAgb24oRCwgJ21vdXNlb3V0Jywgb25Ecm9wSWZPdXRPZkJvdW5kcylcbn1cblxuY29uc3Qgb25Ecm9wID0gKCkgPT4ge1xuICBpZiAoIWRyYWdnZWQpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIGZvckVhY2goZHJhZywgZHJhZ2dhYmxlID0+IHtcbiAgICBjbC5ybShkcmFnZ2FibGUsICdkcmFnZ2VkJylcblxuICAgIGlmIChkcmFnZ2FibGUgPT09IGRyYWdnZWQpIHtcbiAgICAgIGNsLmFkZChkcmFnZ2VkLCAnZHJvcHBlZCcpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNsLnJtKGRyYWdnYWJsZSwgJ2Ryb3BwZWQnKVxuICAgIH1cbiAgfSlcblxuICBkcmFnZ2VkLnN0eWxlLm9wYWNpdHkgPSAxXG5cbiAgZHJhZ2dlZCA9IGZhbHNlXG4gIHN0YXJ0UG9zID0gZmFsc2Vcbn1cblxuY29uc3Qgb25Ecm9wSWZPdXRPZkJvdW5kcyA9IGUgPT4ge1xuICBpZiAoaXNPdXRPZkJvdW5kcyhlKSkge1xuICAgIG9uRHJvcChlKVxuICB9XG59XG5cbmNvbnN0IG9uTW91c2Vtb3ZlID0gZXZ0ID0+IHtcbiAgaWYgKGRyYWdnZWQpIHtcbiAgICBjb25zdCBtYXggPSB7XG4gICAgICBsZWZ0OiBXLmlubmVyV2lkdGggLSBkcmFnZ2VkLmNsaWVudFdpZHRoLFxuICAgICAgdG9wOiBXLmlubmVySGVpZ2h0IC0gZHJhZ2dlZC5jbGllbnRIZWlnaHQsXG4gICAgfVxuXG4gICAgbGV0IG5ld0xlZnQgPSBldnQuY2xpZW50WCAtIGRyYWdnZWQub2Zmc2V0LmxlZnRcbiAgICBpZiAobmV3TGVmdCA8IDApIHtcbiAgICAgIG5ld0xlZnQgPSAwXG4gICAgfSBlbHNlIGlmIChuZXdMZWZ0ID4gbWF4LmxlZnQpIHtcbiAgICAgIG5ld0xlZnQgPSBtYXgubGVmdFxuICAgIH1cblxuICAgIGRyYWdnZWQuc3R5bGUubGVmdCA9IGAke3BlcmNlbnRGcm9tUGl4ZWxzKCdXaWR0aCcsIG5ld0xlZnQpfSVgXG5cbiAgICBsZXQgbmV3VG9wID0gZXZ0LmNsaWVudFkgLSBkcmFnZ2VkLm9mZnNldC50b3BcbiAgICBpZiAobmV3VG9wIDwgMCkge1xuICAgICAgbmV3VG9wID0gMFxuICAgIH0gZWxzZSBpZiAobmV3VG9wID4gbWF4LnRvcCkge1xuICAgICAgbmV3VG9wID0gbWF4LnRvcFxuICAgIH1cbiAgICBkcmFnZ2VkLnN0eWxlLnRvcCA9IGAke3BlcmNlbnRGcm9tUGl4ZWxzKCdIZWlnaHQnLCBuZXdUb3ApfSVgXG4gIH1cbn1cblxuVy5vbmxvYWQgPSAoKSA9PiB7XG4gIGZvckVhY2goZHJhZywgZHJhZ2dhYmxlID0+IHtcbiAgICBjb25zdCBpbWcgPSAkKCcuYmcnLCBkcmFnZ2FibGUpWzBdXG4gICAgaWYgKGltZykge1xuICAgICAgb24oaW1nLCAnZHJhZ3N0YXJ0JywgZG9Ob3RoaW5nKVxuICAgICAgb24oaW1nLCAnbW91c2Vkb3duJywgb25EcmFnKVxuXG4gICAgICBvbihpbWcsIFwidG91Y2hzdGFydFwiLCB0b3VjaEhhbmRsZXIsIHRydWUpXG4gICAgICBvbihpbWcsIFwidG91Y2htb3ZlXCIsIHRvdWNoSGFuZGxlciwgdHJ1ZSlcbiAgICAgIG9uKGltZywgXCJ0b3VjaGVuZFwiLCB0b3VjaEhhbmRsZXIsIHRydWUpXG4gICAgICBvbihpbWcsIFwidG91Y2hjYW5jZWxcIiwgdG91Y2hIYW5kbGVyLCB0cnVlKVxuXG4gICAgICBjb25zdCBwYXJlbnRTdHlsZSA9IGltZy5wYXJlbnROb2RlLnN0eWxlXG4gICAgICBpZiAocGFyZW50U3R5bGUgJiYgcGFyZW50U3R5bGUubGVmdCA9PT0gJzEwMCUnIHx8IHBhcmVudFN0eWxlLmxlZnQgPT09ICctMTAwJScpIHtcbiAgICAgICAgaW1nLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdsb2FkJykpXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgYSA9ICQoJ2EnLCBkcmFnZ2FibGUpWzBdXG4gICAgaWYgKGEpIHtcbiAgICAgIG9uKGEsICd0b3VjaGVuZCcsIGUgPT4ge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfSlcbiAgICB9XG4gIH0pXG59XG5cbi8vIE1lbnVcbmNvbnN0IG1lbnVDb250YWluZXIgPSAkKCcubmF2JylbMF1cbmlmIChtZW51Q29udGFpbmVyKSB7XG4gIGNvbnN0IGFjdGl2ZSA9ICQoJy5hY3RpdmUnLCBtZW51Q29udGFpbmVyKVswXVxuXG4gIGNvbnN0IHRvZ2dsZU1lbnUgPSBlID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBjbC50b2dnbGUobWVudUNvbnRhaW5lciwgJ3Nob3cnKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgaWYgKGFjdGl2ZSkge1xuICAgIG9uKGFjdGl2ZSwgJ2NsaWNrJywgdG9nZ2xlTWVudSlcbiAgfVxufVxuXG4vLyBBYm91dCBwYWdlXG5jb25zdCB0cmlnZ2VyID0gJCgnLmFib3V0LXBhZ2UtdHJpZ2dlcicpWzBdXG5cbmlmICh0cmlnZ2VyKSB7XG4gIG9uKHRyaWdnZXIsIFwiY2xpY2tcIiwgZSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY2wudG9nZ2xlKEQuYm9keSwgXCJhYm91dC12aXNpYmxlXCIpXG5cbiAgICByZXR1cm4gZmFsc2VcbiAgfSlcbn1cbiJdfQ==